(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[310],{6237:function(e,r,t){"use strict";t.d(r,{s:function(){return c},F:function(){return s}});var n=t(7218),u=t(6441),a=t(9251);function c(e){const r=(0,a.Y0)(e);if(r.length>31)throw new Error("bytes32 string must be less than 32 bytes");return(0,u.Dv)((0,u.zo)([r,n.R]).slice(0,32))}function s(e){const r=(0,u.lE)(e);if(32!==r.length)throw new Error("invalid bytes32 - not 32 bytes long");if(0!==r[31])throw new Error("invalid bytes32 string - no null terminator");let t=31;for(;0===r[t-1];)t--;return(0,a.ZN)(r.slice(0,t))}},3377:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/redeemFutureContract",function(){return t(2611)}])},9742:function(e,r,t){"use strict";t.d(r,{h:function(){return f}});var n=t(4051),u=t.n(n),a=t(7294),c=t(6076),s=t(6237),o=t(9874),i=t(8301);function l(e,r,t,n,u,a,c){try{var s=e[a](c),o=s.value}catch(i){return void t(i)}s.done?r(o):Promise.resolve(o).then(n,u)}function p(e){return function(){var r=this,t=arguments;return new Promise((function(n,u){var a=e.apply(r,t);function c(e){l(a,n,u,c,s,"next",e)}function s(e){l(a,n,u,c,s,"throw",e)}c(void 0)}))}}function f(){var e=(0,i.K)().signer,r=(0,a.useCallback)((function(){return function(){var r=p(u().mark((function r(){var t,n;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return",Promise.reject("no account"));case 2:return t=o._.exchange,n=new c.CH(t.address,t.abi,e),r.abrupt("return",n);case 5:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()()}),[e]),t=(0,a.useCallback)((function(e,t){return function(){var n=p(u().mark((function n(){var a,c;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r();case 3:return a=n.sent,n.next=6,a.sell(e,t);case 6:return c=n.sent,n.next=9,c.wait();case 9:return n.abrupt("return",c.hash);case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 15:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(){return n.apply(this,arguments)}}()()}),[r]),n=(0,a.useCallback)((function(e,t){return function(){var n=p(u().mark((function n(){var a,c;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r();case 3:return a=n.sent,n.next=6,a.buy(e,t);case 6:return c=n.sent,n.next=9,c.wait();case 9:return n.abrupt("return",c.hash);case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 15:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(){return n.apply(this,arguments)}}()()}),[r]),l=(0,a.useCallback)((function(e){return function(){var t=p(u().mark((function t(){var n,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r();case 3:return n=t.sent,t.next=6,n.cancelSell(e);case 6:return a=t.sent,t.next=9,a.wait();case 9:return t.abrupt("return",a.hash);case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(){return t.apply(this,arguments)}}()()}),[r]),f=(0,a.useCallback)((function(e){return function(){var t=p(u().mark((function t(){var n,a,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r();case 2:return n=t.sent,t.next=5,n.openForTrades(e);case 5:return a=t.sent,c={sellId:a.sellId.toNumber(),seller:a.seller,futureTokenId:a.futureTokenId.toNumber(),amount:a.amount.toNumber(),status:s.F(a.status)},t.abrupt("return",c);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[r]),d=(0,a.useCallback)((function(){return function(){var e=p(u().mark((function e(){var t,n,a,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r();case 3:return t=e.sent,e.next=6,t.getAllSellIdOpenForTrades();case 6:return n=e.sent,a=n.map((function(e){return f(e.toNumber())})),e.next=10,Promise.all(a);case 10:return c=e.sent,e.abrupt("return",c);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}()()}),[r,f]),v=(0,a.useCallback)((function(e,t){return function(){var n=p(u().mark((function n(){var a,c;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r();case 3:return a=n.sent,n.next=6,a.redeemFromToken(e,t);case 6:return c=n.sent,n.next=9,c.wait();case 9:return n.abrupt("return",c.hash);case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 15:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(){return n.apply(this,arguments)}}()()}),[r]),h=(0,a.useCallback)((function(e,t){return function(){var n=p(u().mark((function n(){var a,c;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r();case 3:return a=n.sent,n.next=6,a.redeemFromNFT(e,t);case 6:return c=n.sent,n.next=9,c.wait();case 9:return n.abrupt("return",c.hash);case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 15:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(){return n.apply(this,arguments)}}()()}),[r]),x=(0,a.useCallback)((function(){return function(){var e=p(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r();case 3:return t=e.sent,e.next=6,t.getUsedNFTs();case 6:return n=e.sent,e.abrupt("return",n.map((function(e){return{customer:e.customer,tokenId:e.tokenId.toNumber(),amount:e.amount.toNumber()}})));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}()()}),[r]);return{getExchangeContract:r,onSell:t,onBuy:n,getOpenTrade:f,getAllOpenTrades:d,cancelSell:l,redeemFromToken:v,getUsedFutureToken:x,redeemFromFutureContract:h}}},1050:function(e,r,t){"use strict";t.d(r,{T:function(){return d}});var n=t(4051),u=t.n(n),a=t(6076),c=t(6237),s=t(9874),o=t(8301);function i(e){return e.getTime()/1e3<<0}var l=t(7294);function p(e,r,t,n,u,a,c){try{var s=e[a](c),o=s.value}catch(i){return void t(i)}s.done?r(o):Promise.resolve(o).then(n,u)}function f(e){return function(){var r=this,t=arguments;return new Promise((function(n,u){var a=e.apply(r,t);function c(e){p(a,n,u,c,s,"next",e)}function s(e){p(a,n,u,c,s,"throw",e)}c(void 0)}))}}function d(){var e=(0,o.K)(),r=e.accountAddress,t=e.signer,n=(0,l.useCallback)((function(){if(!t)return Promise.reject("no account");var e=s._.future;return new a.CH(e.address,e.abi,t)}),[t]);function p(){return(p=f(u().mark((function e(t,a,o,l){var p,f,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r){e.next=3;break}throw new Error("no account address found");case 3:return e.next=5,n();case 5:return p=e.sent,f=c.s(o),e.next=9,p.createNew(r,t,i(a),f,l*Number("1e".concat(s._.token.decimal)),"0x00");case 9:return d=e.sent,e.next=12,d.wait();case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(0),console.error("cound not get future contract",e.t0),e.abrupt("return",Promise.reject("cound not get future contract & Error:".concat(e.t0)));case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}var d=(0,l.useCallback)((function(){(function(){var e=f(u().mark((function e(){var r,t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n();case 3:return r=e.sent,e.next=6,r.setApprovalForAll(s._.exchange.address,!0);case 6:return t=e.sent,e.next=9,t.wait();case 9:return e.abrupt("return",t.hash);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}})()()}),[n]),v=(0,l.useCallback)((function(e){return function(){var e=f(u().mark((function e(t){var a,c,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r){e.next=3;break}throw new Error("no account address found");case 3:return e.next=5,n();case 5:return a=e.sent,e.next=8,a.getFutureTokenData(r,t);case 8:return c=e.sent,o={id:c.futureTokenId.toNumber(),totalSupply:c.totalSupply.toNumber(),balance:c.balance.toNumber(),expire:new Date(1e3*c.expire.toNumber()).toLocaleDateString("th-TH"),currentPrice:c.currentPrice.toNumber()/Number("1e".concat(s._.token.decimal))},e.abrupt("return",o);case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",Promise.reject("cound not get future contract & Error:".concat(e.t0)));case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(r){return e.apply(this,arguments)}}()(e)}),[r,n]),h=(0,l.useCallback)((function(){return function(){var e=f(u().mark((function e(){var t,a,c,s,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r){e.next=3;break}throw new Error("no account address found");case 3:return e.next=5,n();case 5:return t=e.sent,e.next=8,t.getLatestIdCreated();case 8:for(a=e.sent,c=[],s=1;s<=a.toNumber();s++)o=v(s),c.push(o);return e.next=13,Promise.all(c);case 13:return e.abrupt("return",e.sent);case 16:e.prev=16,e.t0=e.catch(0);case 18:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}()()}),[r,n,v]);return{getFutureContract:n,newFutureContract:function(e,r,t,n){return p.apply(this,arguments)},getFutureTokenData:v,getAllFutureTokenData:h,approveAll:d}}},2611:function(e,r,t){"use strict";t.r(r);var n=t(4051),u=t.n(n),a=t(5893),c=t(7294),s=t(9742),o=t(1050);function i(e,r,t,n,u,a,c){try{var s=e[a](c),o=s.value}catch(i){return void t(i)}s.done?r(o):Promise.resolve(o).then(n,u)}function l(e){return function(){var r=this,t=arguments;return new Promise((function(n,u){var a=e.apply(r,t);function c(e){i(a,n,u,c,s,"next",e)}function s(e){i(a,n,u,c,s,"throw",e)}c(void 0)}))}}r.default=function(e){var r=(0,o.T)(),t=r.getAllFutureTokenData,n=r.approveAll,i=(0,s.h)().redeemFromFutureContract,p=(0,c.useState)([]),f=p[0],d=p[1],v=(0,c.useState)(0),h=v[0],x=v[1],m=(0,c.useState)(0),b=m[0],w=m[1],k=(0,c.useState)(""),y=k[0],g=k[1];function j(){return(j=l(u().mark((function e(){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(h,b);case 2:r=e.sent,g(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,c.useEffect)((function(){function e(){return(e=l(u().mark((function e(){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:(r=e.sent)&&d(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,y]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-[40px]",children:"Redeem Future Contract"}),(0,a.jsx)("hr",{}),(0,a.jsx)("div",{children:"Your Token List"}),(0,a.jsx)("hr",{}),f.filter((function(e){return e.balance>0})).map((function(e,r){return(0,a.jsxs)("div",{className:" cursor-pointer",onClick:function(){return r=e.id,t=e.balance,x(r),void w(t);var r,t},children:[(0,a.jsxs)("div",{children:["Future Token Id: ",e.id]}),(0,a.jsxs)("div",{children:["Balance: ",e.balance]}),(0,a.jsxs)("div",{children:["Total Supply: ",e.totalSupply]}),(0,a.jsxs)("div",{children:["Expire: ",e.expire]}),(0,a.jsxs)("div",{children:["Price: ",e.currentPrice]}),(0,a.jsx)("hr",{})]},r)})),(0,a.jsx)("hr",{}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:"px-4 py-2 bg-purple-200 border-2 rounded-xl",onClick:n,children:"Arrpove"})}),(0,a.jsx)("hr",{}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"input",children:"Id"}),(0,a.jsx)("input",{type:"text",className:" px-4 rounded-md border-2",value:h,onChange:function(e){return x(Number.parseInt(e.target.value))}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"amount",children:"Amount"}),(0,a.jsx)("input",{type:"text",className:" px-4 rounded-md border-2",value:b,onChange:function(e){return w(Number.parseInt(e.target.value))}})]}),(0,a.jsx)("button",{className:" bg-red-300 hover:bg-red-400 hover:text-white duration-500 px-4 py-2 border-2 rounded-lg",onClick:function(){return j.apply(this,arguments)},children:"Redeem"})]})]})}}},function(e){e.O(0,[774,888,179],(function(){return r=3377,e(e.s=r);var r}));var r=e.O();_N_E=r}]);